<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>The Cycling Infrastructure Prioritisation Toolkit: Manual</title>
  <meta name="description" content="This is the manual of the Cycling Infrastructure Prioritisation Toolkit (CyIPT).">
  <meta name="generator" content="bookdown 0.7.1 and GitBook 2.6.7">

  <meta property="og:title" content="The Cycling Infrastructure Prioritisation Toolkit: Manual" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is the manual of the Cycling Infrastructure Prioritisation Toolkit (CyIPT)." />
  <meta name="github-repo" content="cyipt/cyipt-website" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="The Cycling Infrastructure Prioritisation Toolkit: Manual" />
  
  <meta name="twitter:description" content="This is the manual of the Cycling Infrastructure Prioritisation Toolkit (CyIPT)." />
  

<meta name="author" content="The CyIPT team">



  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="layer-descriptions.html">
<link rel="next" href="general-comments.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">The CyIPT Manual</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#feedback"><i class="fa fa-check"></i>Feedback</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#the-cyipt-team"><i class="fa fa-check"></i>The CyIPT Team</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="how-cyipt-works.html"><a href="how-cyipt-works.html"><i class="fa fa-check"></i><b>2</b> How CyIPT works</a></li>
<li class="chapter" data-level="3" data-path="key-concepts.html"><a href="key-concepts.html"><i class="fa fa-check"></i><b>3</b> Key concepts</a><ul>
<li class="chapter" data-level="3.1" data-path="key-concepts.html"><a href="key-concepts.html#accuracy"><i class="fa fa-check"></i><b>3.1</b> Accuracy</a></li>
<li class="chapter" data-level="3.2" data-path="key-concepts.html"><a href="key-concepts.html#open-street-map"><i class="fa fa-check"></i><b>3.2</b> Open Street Map</a></li>
<li class="chapter" data-level="3.3" data-path="key-concepts.html"><a href="key-concepts.html#cycling-flows-from-the-pct"><i class="fa fa-check"></i><b>3.3</b> Cycling Flows from the PCT</a></li>
<li class="chapter" data-level="3.4" data-path="key-concepts.html"><a href="key-concepts.html#rate-limiting"><i class="fa fa-check"></i><b>3.4</b> Rate Limiting</a></li>
<li class="chapter" data-level="3.5" data-path="key-concepts.html"><a href="key-concepts.html#geometry-simplification"><i class="fa fa-check"></i><b>3.5</b> Geometry Simplification</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="layer-descriptions.html"><a href="layer-descriptions.html"><i class="fa fa-check"></i><b>4</b> Layer descriptions</a><ul>
<li class="chapter" data-level="4.1" data-path="layer-descriptions.html"><a href="layer-descriptions.html#existing-infrastructure"><i class="fa fa-check"></i><b>4.1</b> Existing infrastructure</a><ul>
<li class="chapter" data-level="4.1.1" data-path="layer-descriptions.html"><a href="layer-descriptions.html#cycle-infrastructure"><i class="fa fa-check"></i><b>4.1.1</b> Cycle infrastructure</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="layer-descriptions.html"><a href="layer-descriptions.html#speed-limits"><i class="fa fa-check"></i><b>4.2</b> Speed limits</a></li>
<li class="chapter" data-level="4.3" data-path="layer-descriptions.html"><a href="layer-descriptions.html#footways"><i class="fa fa-check"></i><b>4.3</b> Footways</a></li>
<li class="chapter" data-level="4.4" data-path="layer-descriptions.html"><a href="layer-descriptions.html#schemes"><i class="fa fa-check"></i><b>4.4</b> Schemes</a></li>
<li class="chapter" data-level="4.5" data-path="layer-descriptions.html"><a href="layer-descriptions.html#recommended-infrastructure"><i class="fa fa-check"></i><b>4.5</b> Recommended infrastructure</a></li>
<li class="chapter" data-level="4.6" data-path="layer-descriptions.html"><a href="layer-descriptions.html#road-widths"><i class="fa fa-check"></i><b>4.6</b> Road widths</a></li>
<li class="chapter" data-level="4.7" data-path="layer-descriptions.html"><a href="layer-descriptions.html#propensity-to-cycle-tool"><i class="fa fa-check"></i><b>4.7</b> Propensity to Cycle Tool</a></li>
<li class="chapter" data-level="4.8" data-path="layer-descriptions.html"><a href="layer-descriptions.html#traffic-counts"><i class="fa fa-check"></i><b>4.8</b> Traffic counts</a></li>
<li class="chapter" data-level="4.9" data-path="layer-descriptions.html"><a href="layer-descriptions.html#collisions-roads"><i class="fa fa-check"></i><b>4.9</b> Collisions roads</a></li>
<li class="chapter" data-level="4.10" data-path="layer-descriptions.html"><a href="layer-descriptions.html#collisions-junctions"><i class="fa fa-check"></i><b>4.10</b> Collisions junctions</a></li>
<li class="chapter" data-level="4.11" data-path="layer-descriptions.html"><a href="layer-descriptions.html#collisions-points"><i class="fa fa-check"></i><b>4.11</b> Collisions points</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="technical-details.html"><a href="technical-details.html"><i class="fa fa-check"></i><b>5</b> Technical details</a><ul>
<li class="chapter" data-level="5.1" data-path="technical-details.html"><a href="technical-details.html#data-preparation"><i class="fa fa-check"></i><b>5.1</b> Data Preparation</a></li>
<li class="chapter" data-level="5.2" data-path="technical-details.html"><a href="technical-details.html#cyipt-master-script"><i class="fa fa-check"></i><b>5.2</b> CyIPT Master Script</a></li>
<li class="chapter" data-level="5.3" data-path="technical-details.html"><a href="technical-details.html#settings"><i class="fa fa-check"></i><b>5.3</b> Settings</a></li>
<li class="chapter" data-level="5.4" data-path="technical-details.html"><a href="technical-details.html#regions-to-do"><i class="fa fa-check"></i><b>5.4</b> Regions to Do</a></li>
<li class="chapter" data-level="5.5" data-path="technical-details.html"><a href="technical-details.html#libraries"><i class="fa fa-check"></i><b>5.5</b> Libraries</a></li>
<li class="chapter" data-level="5.6" data-path="technical-details.html"><a href="technical-details.html#step-1-download-the-data"><i class="fa fa-check"></i><b>5.6</b> Step 1: Download the Data</a></li>
<li class="chapter" data-level="5.7" data-path="technical-details.html"><a href="technical-details.html#step-2-clean-the-osm-tags"><i class="fa fa-check"></i><b>5.7</b> Step 2: Clean the OSM Tags</a><ul>
<li class="chapter" data-level="5.7.1" data-path="technical-details.html"><a href="technical-details.html#detail"><i class="fa fa-check"></i><b>5.7.1</b> Detail</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="technical-details.html"><a href="technical-details.html#step-3-get-traffic-counts"><i class="fa fa-check"></i><b>5.8</b> Step 3: Get traffic counts</a><ul>
<li class="chapter" data-level="5.8.1" data-path="technical-details.html"><a href="technical-details.html#details"><i class="fa fa-check"></i><b>5.8.1</b> Details</a></li>
</ul></li>
<li class="chapter" data-level="5.9" data-path="technical-details.html"><a href="technical-details.html#step-4-split-the-lines-at-each-junction"><i class="fa fa-check"></i><b>5.9</b> Step 4: Split the lines at each junction</a><ul>
<li class="chapter" data-level="5.9.1" data-path="technical-details.html"><a href="technical-details.html#details-1"><i class="fa fa-check"></i><b>5.9.1</b> Details</a></li>
</ul></li>
<li class="chapter" data-level="5.10" data-path="technical-details.html"><a href="technical-details.html#step-5-get-the-pct-estimate-of-number-of-cyclists"><i class="fa fa-check"></i><b>5.10</b> Step 5: Get the PCT estimate of number of cyclists</a><ul>
<li class="chapter" data-level="5.10.1" data-path="technical-details.html"><a href="technical-details.html#details-2"><i class="fa fa-check"></i><b>5.10.1</b> Details</a></li>
</ul></li>
<li class="chapter" data-level="5.11" data-path="technical-details.html"><a href="technical-details.html#step-6-get-road-width-estimates-and-collisions"><i class="fa fa-check"></i><b>5.11</b> Step 6: Get road width estimates and collisions</a></li>
<li class="chapter" data-level="5.12" data-path="technical-details.html"><a href="technical-details.html#step-7-evaluate-infrastructure-options"><i class="fa fa-check"></i><b>5.12</b> Step 7: Evaluate Infrastructure Options</a></li>
<li class="chapter" data-level="5.13" data-path="technical-details.html"><a href="technical-details.html#step-8-compare-widths-needed-to-widths-available"><i class="fa fa-check"></i><b>5.13</b> Step 8: Compare Widths Needed to Widths Available</a></li>
<li class="chapter" data-level="5.14" data-path="technical-details.html"><a href="technical-details.html#step-9-group-into-schemes"><i class="fa fa-check"></i><b>5.14</b> Step 9: Group into schemes</a></li>
<li class="chapter" data-level="5.15" data-path="technical-details.html"><a href="technical-details.html#step-10-get-uptake-and-benefits"><i class="fa fa-check"></i><b>5.15</b> Step 10: get uptake and benefits</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="general-comments.html"><a href="general-comments.html"><i class="fa fa-check"></i><b>6</b> General Comments</a><ul>
<li class="chapter" data-level="6.1" data-path="general-comments.html"><a href="general-comments.html#uk-emphasis"><i class="fa fa-check"></i><b>6.1</b> UK emphasis</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>7</b> References</a></li>
<li class="divider"></li>
<li><a href="https://cyipt.bike" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">The Cycling Infrastructure Prioritisation Toolkit: Manual</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="technical-details" class="section level1">
<h1><span class="header-section-number">5</span> Technical details</h1>
<p>CyITP is developed in the R Programming language and is an open source project. The code is available at <a href="https://github.com/cyipt" class="uri">https://github.com/cyipt</a>. CyIPT consists of two main parts; the R based analysis code, and the website, which is a mixture of HTML/CSS/JavaScript with a PostgreSQL database accessed via a PHP-based API.</p>
<p>This manual focusses on the R based analysis code, as the website exists purely for visualisation and ease of use.</p>
<div id="data-preparation" class="section level2">
<h2><span class="header-section-number">5.1</span> Data Preparation</h2>
<p>CyIPT is reliant on some pre-existing datasets from third parties. While many of these are publically available, CyIPT required them to be pre-processed before use. These scripts are provided for context, but in most cases, users should download the pre-processed data directly from GitHub.</p>
</div>
<div id="cyipt-master-script" class="section level2">
<h2><span class="header-section-number">5.2</span> CyIPT Master Script</h2>
<p>The CyIPT master script <a href="https://github.com/cyipt/cyipt/blob/master/scripts/cyipt.R" class="uri">https://github.com/cyipt/cyipt/blob/master/scripts/cyipt.R</a> can be used to run the whole CyIPT process. It manages several global settings.</p>
</div>
<div id="settings" class="section level2">
<h2><span class="header-section-number">5.3</span> Settings</h2>
<p>Should the code skip regions that have already been done?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">overwrite</code></pre></div>
<p>Some stages overwrite existing files, for example by adding an extra column of data. Note that not overwriting may cause later stages to fail if they expect earlier stages results to be in the starting file.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ncores</code></pre></div>
<p>Some functions use parallel processing how many clusters should be run? This should be less than the number of cores on your computer.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">verbose</code></pre></div>
<p>Get extra messages and information while CyIPT is running.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">all.regions</code></pre></div>
<p>Ignore the regions to do file and run for all regions.</p>
</div>
<div id="regions-to-do" class="section level2">
<h2><span class="header-section-number">5.4</span> Regions to Do</h2>
<p>If <code>all.regions = FALSE</code> CyIPT will choose which regions to run for based on the RegionsToDo file at <a href="https://github.com/cyipt/cyipt/blob/master/input-data/RegionsToDo.csv" class="uri">https://github.com/cyipt/cyipt/blob/master/input-data/RegionsToDo.csv</a></p>
<p>Placing <code>y</code> in the do column of this csv file will rerun the that region.</p>
<p>CyIPT uses the 2011 travel to work areas produces by the Office for National Statistics (ONS). However it could be changes to accept a different se to regions.</p>
</div>
<div id="libraries" class="section level2">
<h2><span class="header-section-number">5.5</span> Libraries</h2>
<p>CyIPT requires the following R libraries, which can be installed as follows:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pkgs =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;sf&quot;</span>,
         <span class="st">&quot;osmdata&quot;</span>,
         <span class="st">&quot;stringr&quot;</span>,
         <span class="st">&quot;dplyr&quot;</span>,
         <span class="st">&quot;parallel&quot;</span>,
         <span class="st">&quot;xgboost&quot;</span>,
         <span class="st">&quot;igraph&quot;</span>,
         <span class="st">&quot;tmap&quot;</span>
         )</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">install.packages</span>(pkgs)</code></pre></div>
<p>and loaded as follows:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">vapply</span>(pkgs, require, <span class="ot">TRUE</span>, <span class="dt">character.only =</span> <span class="ot">TRUE</span>)</code></pre></div>
<pre><code>##       sf  osmdata  stringr    dplyr parallel  xgboost   igraph     tmap 
##     TRUE     TRUE     TRUE     TRUE     TRUE     TRUE     TRUE     TRUE</code></pre>
</div>
<div id="step-1-download-the-data" class="section level2">
<h2><span class="header-section-number">5.6</span> Step 1: Download the Data</h2>
<p><a href="https://github.com/cyipt/cyipt/blob/master/scripts/prep_data/download-osm.R" class="uri">https://github.com/cyipt/cyipt/blob/master/scripts/prep_data/download-osm.R</a></p>
<p>This script downloads the OSM road and path network for each region.</p>
<p><strong>Inputs:</strong></p>
<p><code>Regions.todo</code></p>
<p>Boundaries file “../cyipt-bigdata/boundaries/TTWA/TTWA_England.Rds”</p>
<p><strong>Outputs:</strong></p>
<p>Region Boundaries “../cyipt-bigdata/osm-raw/region/bounds.Rds”</p>
<p>OSM road network “../cyipt-bigdata/osm-raw/region/osm-lines.Rds”</p>
<p>OSM road junction points “../cyipt-bigdata/osm-raw/region/osm-junction-points.Rds” <strong>Parallelised:</strong></p>
<p>Yes</p>
</div>
<div id="step-2-clean-the-osm-tags" class="section level2">
<h2><span class="header-section-number">5.7</span> Step 2: Clean the OSM Tags</h2>
<p><a href="https://github.com/cyipt/cyipt/blob/master/scripts/prep_data/clean_osm.R" class="uri">https://github.com/cyipt/cyipt/blob/master/scripts/prep_data/clean_osm.R</a></p>
<p>This script “cleans” the OSM data by removing or correcting errors and filling in missing data with best guesses. Guessing is required, as some later stages of CyIPT require information (such as speed limits) which is not always available. In isolated cases of incorrect guesses it is best to correct the value in the OSM using the “edit in the OSM” button on the CyIPT website. These corrections will then be incorporated into the next build of CyIPT. In general cases of CyIPT miss-guessing, please submit and issue via GitHub <a href="https://github.com/cyipt/cyipt/issues" class="uri">https://github.com/cyipt/cyipt/issues</a></p>
<p><strong>Inputs:</strong></p>
<p><code>Regions.todo</code></p>
<p>OSM road network “../cyipt-bigdata/osm-raw/region/osm-lines.Rds”</p>
<p><strong>Outputs:</strong></p>
<p>OSM road network “../cyipt-bigdata/osm-clean/region/osm-lines.Rds”</p>
<p><strong>Parallelised:</strong></p>
<p>No</p>
<div id="detail" class="section level3">
<h3><span class="header-section-number">5.7.1</span> Detail</h3>
<p>The cleaning process consist of the following stages:</p>
<ol style="list-style-type: decimal">
<li>Removing un-allowed road types (e.g. planned or demolished)</li>
<li>Replacing depreciated highway tags</li>
<li>Cleaning the junction tag</li>
<li>Summarising the one-way nature of roads</li>
<li>Guessing the max speed of roads with an unknown max speed based on road type</li>
<li>Guessing the presence of footways (pavements) with unknown footway status</li>
<li>Summarising the presence of bridges and tunnels</li>
<li>Cleaning the segregation status of cycle infrastructure</li>
<li>Cleating a summary of the road type</li>
<li>Cleaning and/or guessing the number and nature of lanes in each direction</li>
<li>Cleaning the tagging of cycle infrastructure and improving detail of what is on each side of the road.</li>
</ol>
</div>
</div>
<div id="step-3-get-traffic-counts" class="section level2">
<h2><span class="header-section-number">5.8</span> Step 3: Get traffic counts</h2>
<p><a href="https://github.com/cyipt/cyipt/blob/master/scripts/prep_data/get_traffic.R" class="uri">https://github.com/cyipt/cyipt/blob/master/scripts/prep_data/get_traffic.R</a></p>
<p>This script assigns the point traffic count data to the road network.</p>
<p><strong>Inputs:</strong></p>
<p><code>Regions.todo</code></p>
<p>OSM road network “../cyipt-bigdata/osm-clean/region/osm-lines.Rds”</p>
<p>Traffic Points “../cyipt-bigdata/traffic/traffic.Rds”</p>
<p><strong>Outputs:</strong></p>
<p>OSM road network “../cyipt-bigdata/osm-clean/region/osm-lines.Rds”</p>
<p><strong>Parallelised:</strong></p>
<p>No</p>
<div id="details" class="section level3">
<h3><span class="header-section-number">5.8.1</span> Details</h3>
<p>This scrip divides the point traffic counts based on whether they are on classified (e.g. M21, B340) or unclassified roads. Unclassified road points are matched to the nearest road in the OSM, and therefore the value only extends a short distance from the point location. For classified roads, a series of Voronoi polygons are constructed around the points and all the road segments within each polygon are assigned the value of their nearest point. This provides continuous coverage, but can produce some erroneous results such as off ramps having the same traffic levels as the main carriageways.</p>
<p>In both cases, the script takes the Annual Average Daily Traffic (AADT) value from the most recent available year. For the strategic road network, data is mostly from 2015/2016, but for minor roads, it can be significantly earlier. For the purposes of CyIPT is the traffic data is mostly used for identify the very busy and most hostile roads, thus this inconstancy of data is not a significant problem. However, users intending to use the data or method for other purposes should consider the implications of this inconstancy within the data.</p>
</div>
</div>
<div id="step-4-split-the-lines-at-each-junction" class="section level2">
<h2><span class="header-section-number">5.9</span> Step 4: Split the lines at each junction</h2>
<p><a href="https://github.com/cyipt/cyipt/blob/master/scripts/prep_data/prep_osm.R" class="uri">https://github.com/cyipt/cyipt/blob/master/scripts/prep_data/prep_osm.R</a></p>
<p>This script splits the roads at each junction into road segments.</p>
<p><strong>Inputs:</strong></p>
<p><code>Regions.todo</code></p>
<p>OSM road network “../cyipt-bigdata/osm-clean/region/osm-lines.Rds”</p>
<p>OSM road junction points “../cyipt-bigdata/osm-raw/region/osm-junction-points.Rds”</p>
<p><strong>Outputs:</strong></p>
<p>OSM road network “../cyipt-bigdata/osm-prep/region/osm-lines.Rds”</p>
<p><strong>Parallelised:</strong></p>
<p>No</p>
<div id="details-1" class="section level3">
<h3><span class="header-section-number">5.9.1</span> Details</h3>
<p>The splitting of the roads at junctions is mostly required for the later application of the PCT data. Within the OSM a road may be represented by a single long line crossing several junctions. However, at each junction cyclists may join or leave the road. Therefore, it is not appropriate to analyse the road network as it is represented in the OSM. By splitting the road network into segments it ensures that, the analysis is appropriately detailed. Note the splitting is done by cutting tiny holes out of the road lines (r = 0.01m) therefore the lines are no longer touching; this would prevent this dataset being used in a routing engine.</p>
</div>
</div>
<div id="step-5-get-the-pct-estimate-of-number-of-cyclists" class="section level2">
<h2><span class="header-section-number">5.10</span> Step 5: Get the PCT estimate of number of cyclists</h2>
<p><a href="https://github.com/cyipt/cyipt/blob/master/scripts/prep_data/get_pct.R" class="uri">https://github.com/cyipt/cyipt/blob/master/scripts/prep_data/get_pct.R</a></p>
<p><strong>Inputs:</strong></p>
<p><code>Regions.todo</code></p>
<p>OSM road network “../cyipt-bigdata/osm-prep/region/osm-lines.Rds”</p>
<p>PCT LSOA Routes “../cyipt-securedata/pct-routes-all.Rds”</p>
<p>TTWA boundaries “../cyipt-bigdata/boundaries/TTWA/TTWA_England.Rds”</p>
<p><strong>Outputs:</strong></p>
<p>OSM road network “../cyipt-bigdata/osm-prep/region/osm-lines.Rds”</p>
<p>PCT LSOA Routes (Regional) “../cyipt-securedata/pct-regions/region.Rds”</p>
<p>PCT to OSM lookup (Regional) “../cyipt-bigdata/osm-prep/region/pct2osm.Rds”</p>
<p>OSM to PCT lookup (regional) “../cyipt-bigdata/osm-prep/region/osm2pct.Rds”</p>
<p><strong>Parallelised:</strong></p>
<p>Yes</p>
<div id="details-2" class="section level3">
<h3><span class="header-section-number">5.10.1</span> Details</h3>
<p>This script matches the Propensity to Cycle Tool (PCT) LSOA route data with individual road segments to count the number of cyclists on each road segment. Values from each of the five PCT scenarios are recorded:</p>
<pre><code>Census 2011
Government Target
Gender Equality
Go Dutch
Ebikes</code></pre>
<p>While the matching process is reasonably robust, small errors can occur resulting in missing segments, or double counting.</p>
<p>As the PCT data was unidirectional routed (A to B, but not B to A) the results are less accurate on dual carriageways. For example, the PCT is constructed from Census 2011 Origin-Destination data matched to routes produced by CycleStreets. The Origin and Destinations are Lower Level Super Output Areas. The census state that 30 people live in LSOA A and work in LSOA B, and 50 people live in LSOA B and work in LSOA A. The CycleStreets provide a route from A to B, and the PCT assign this route a value of 80 (50 + 30). This method does not therefore take account of the route A to B being different from the route B to A, due to one way streets, roundabouts etc. Nor does it consider that commuters return home at the end of the day.</p>
<p>In these cases, the number of cyclists is split between the carriageways with usually with most on one carriageway (see Figure <a href="technical-details.html#fig:unidirectional">5.1</a>).</p>
<div class="figure"><span id="fig:unidirectional"></span>
<img src="../images/unidirectional.png" alt="Effects of Unidirectional Routing." width="960" />
<p class="caption">
Figure 5.1: Effects of Unidirectional Routing.
</p>
</div>
</div>
</div>
<div id="step-6-get-road-width-estimates-and-collisions" class="section level2">
<h2><span class="header-section-number">5.11</span> Step 6: Get road width estimates and collisions</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">source</span>(<span class="st">&quot;scripts/prep_data/get_widths.R&quot;</span>)
<span class="kw">source</span>(<span class="st">&quot;scripts/prep_data/get_collisions.R&quot;</span>)</code></pre></div>
</div>
<div id="step-7-evaluate-infrastructure-options" class="section level2">
<h2><span class="header-section-number">5.12</span> Step 7: Evaluate Infrastructure Options</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">source</span>(<span class="st">&quot;scripts/select_infra/select_infra.R&quot;</span>)</code></pre></div>
</div>
<div id="step-8-compare-widths-needed-to-widths-available" class="section level2">
<h2><span class="header-section-number">5.13</span> Step 8: Compare Widths Needed to Widths Available</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">source</span>(<span class="st">&quot;scripts/select_infra/compare_widths.R&quot;</span>)</code></pre></div>
</div>
<div id="step-9-group-into-schemes" class="section level2">
<h2><span class="header-section-number">5.14</span> Step 9: Group into schemes</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">source</span>(<span class="st">&quot;scripts/select_infra/make_schemes2.R&quot;</span>)</code></pre></div>
</div>
<div id="step-10-get-uptake-and-benefits" class="section level2">
<h2><span class="header-section-number">5.15</span> Step 10: get uptake and benefits</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">source</span>(<span class="st">&quot;scripts/uptake/calc_uptake_routechange3.R&quot;</span>)</code></pre></div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="layer-descriptions.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="general-comments.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/cyipt/cyipt-website/edit/master/man/index.Rmd",
"text": "Edit"
},
"download": ["manual.pdf"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
